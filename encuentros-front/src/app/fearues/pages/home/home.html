<body>
  <header>
    <div class="top">
      <div class="brand">
        <div class="logo">💬</div>
        <div class="month">{{month}}</div>
      </div>
      <button class="btn-create" (click)="toggleCreate()">➕ Crear encuentro</button>
    </div>
  </header>

  <!-- Formulario creación de encuentro -->
  <section *ngIf="showCreate" class="create-section" (click)="toggleCreate()">
    <form (ngSubmit)="createEncuentro()" class="create-form" (click)="$event.stopPropagation()">
      <div class="form-header">
        <h2>✨ Crear Nuevo Encuentro</h2>
        <button type="button" class="btn-close" (click)="toggleCreate()" aria-label="Cerrar">✕</button>
      </div>
      
      <div class="form-body">
        <div class="form-group">
          <label for="titulo">📌 Título del encuentro</label>
          <input 
            id="titulo"
            name="titulo" 
            [(ngModel)]="newEncuentro.titulo" 
            placeholder="Ej: Reunión con el equipo"
            required 
          />
        </div>
        
        <div class="form-group">
          <label for="descripcion">📝 Descripción</label>
          <textarea 
            id="descripcion"
            name="descripcion" 
            [(ngModel)]="newEncuentro.descripcion"
            placeholder="Describe los detalles del encuentro..."
            required
          ></textarea>
        </div>
        
        <div class="form-group">
          <label for="lugar">📍 Lugar</label>
          <input 
            id="lugar"
            name="lugar" 
            [(ngModel)]="newEncuentro.lugar"
            placeholder="Ej: Cafetería Central"
            required 
          />
        </div>
        
        <div class="form-group">
          <label for="fecha">🗓️ Fecha y hora</label>
          <input 
            id="fecha"
            type="datetime-local" 
            name="fecha" 
            [(ngModel)]="newEncuentro.fecha" 
            required 
          />
        </div>
      </div>
      
      <div class="form-footer">
        <button type="button" class="btn-secondary" (click)="toggleCreate()">
          Cancelar
        </button>
        <button type="submit" class="btn-primary" [disabled]="creating">
          <span *ngIf="!creating">✓ Crear Encuentro</span>
          <span *ngIf="creating">⏳ Creando...</span>
        </button>
      </div>
    </form>
  </section>

  <main class="container">
    <!-- KPI -->
    <section class="kpi" aria-label="Resumen">
      <div class="item"><div class="big">{{encuentrosHoy}}</div><div>Encuentros hoy</div></div>
      <div class="item"><div class="big">{{encuentrosMes}}</div><div>Este mes</div></div>
      <div class="item"><div class="big">{{encuentrosPendientes}}</div><div>Pendientes</div></div>
    </section>

    <!-- Calendario -->
    <section class="calendar" aria-label="Calendario mensual">
      <div class="cal-head">
        <div>Lun</div><div>Mar</div><div>Mié</div><div>Jue</div><div>Vie</div><div>Sáb</div><div>Dom</div>
      </div>
      <div class="cal-grid">
        <div class="day" *ngFor="let d of days">
          <div class="dnum">{{ d }}</div>
          <div class="dot" *ngIf="daysWithEncuentros.has(d)"></div>
        </div>
      </div>
    </section>

    <!-- Lista de próximos -->
    <section class="list" aria-label="Próximos encuentros">
      <div *ngIf="upcoming && upcoming.length === 0" class="muted">No hay próximos encuentros</div>
      <div class="card" *ngFor="let e of upcoming">
        <div>
          <strong>{{ e.titulo }}</strong><br>
          <span class="muted">{{ e.displayWhen }}</span>
          <div class="small muted">{{ e.descripcion }}</div>
        </div>
      </div>
    </section>
  </main>

  <!-- Navegación inferior -->
  <nav class="bottom" aria-label="Navegación">
    <div class="nav-wrap">
      <a class="tab active" routerLink="/home">🗓️ <span>Calendario</span></a>
      <a class="tab" routerLink="/chats">💬 <span>Chats</span></a>
      <a class="tab" routerLink="/search">🔎 <span>Buscar</span></a>
      <a class="tab" routerLink="/account">⚙️ <span>Cuenta</span></a>
      <a class="tab" routerLink="/notifications">🔔 <span>Notificaciones</span></a>
    </div>
  </nav>
</body>
