<body>
  <header>
    <div class="top">
      <div class="brand">
        <div class="logo">ğŸ’¬</div>
        <div class="month">{{month}}</div>
      </div>
      <button class="btn-create" (click)="toggleCreate()">â• Crear encuentro</button>
    </div>
  </header>

  <!-- Formulario creaciÃ³n de encuentro -->
  <section *ngIf="showCreate" class="create-section" (click)="toggleCreate()">
    <form (ngSubmit)="createEncuentro()" class="create-form" (click)="$event.stopPropagation()">
      <div class="form-header">
        <h2>âœ¨ Crear Nuevo Encuentro</h2>
        <button type="button" class="btn-close" (click)="toggleCreate()" aria-label="Cerrar">âœ•</button>
      </div>
      
      <div class="form-body">
        <div class="form-group">
          <label for="titulo">ğŸ“Œ TÃ­tulo del encuentro</label>
          <input 
            id="titulo"
            name="titulo" 
            [(ngModel)]="newEncuentro.titulo" 
            placeholder="Ej: ReuniÃ³n con el equipo"
            required 
          />
        </div>
        
        <div class="form-group">
          <label for="descripcion">ğŸ“ DescripciÃ³n</label>
          <textarea 
            id="descripcion"
            name="descripcion" 
            [(ngModel)]="newEncuentro.descripcion"
            placeholder="Describe los detalles del encuentro..."
            required
          ></textarea>
        </div>
        
        <div class="form-group">
          <label for="lugar">ğŸ“ Lugar</label>
          <input 
            id="lugar"
            name="lugar" 
            [(ngModel)]="newEncuentro.lugar"
            placeholder="Ej: CafeterÃ­a Central"
            required 
          />
        </div>
        
        <div class="form-group">
          <label for="fecha">ğŸ—“ï¸ Fecha y hora</label>
          <input 
            id="fecha"
            type="datetime-local" 
            name="fecha" 
            [(ngModel)]="newEncuentro.fecha" 
            required 
          />
        </div>
      </div>
      
      <div class="form-footer">
        <button type="button" class="btn-secondary" (click)="toggleCreate()">
          Cancelar
        </button>
        <button type="submit" class="btn-primary" [disabled]="creating">
          <span *ngIf="!creating">âœ“ Crear Encuentro</span>
          <span *ngIf="creating">â³ Creando...</span>
        </button>
      </div>
    </form>
  </section>

  <main class="container">
    <!-- KPI -->
    <section class="kpi" aria-label="Resumen">
      <div class="item"><div class="big">{{encuentrosHoy}}</div><div>Encuentros hoy</div></div>
      <div class="item"><div class="big">{{encuentrosMes}}</div><div>Este mes</div></div>
      <div class="item"><div class="big">{{encuentrosPendientes}}</div><div>Pendientes</div></div>
    </section>

    <!-- Calendario -->
    <section class="calendar" aria-label="Calendario mensual">
      <div class="cal-head">
        <div>Lun</div><div>Mar</div><div>MiÃ©</div><div>Jue</div><div>Vie</div><div>SÃ¡b</div><div>Dom</div>
      </div>
      <div class="cal-grid">
        <!-- Celdas vacÃ­as antes del dÃ­a 1 -->
        <div class="day empty" *ngFor="let empty of emptyDays"></div>
        <!-- DÃ­as del mes -->
        <div class="day" *ngFor="let d of days">
          <div class="dnum">{{ d }}</div>
          <div class="dot" *ngIf="daysWithEncuentros.has(d)"></div>
        </div>
      </div>
    </section>

    <!-- Lista de prÃ³ximos -->
    <section class="list" aria-label="PrÃ³ximos encuentros">
      <div *ngIf="upcoming && upcoming.length === 0" class="muted">No hay prÃ³ximos encuentros</div>
      <div class="card" *ngFor="let e of upcoming">
        <div>
          <strong>{{ e.titulo }}</strong><br>
          <span class="muted">{{ e.displayWhen }}</span>
          <div class="small muted">{{ e.descripcion }}</div>
          
          <!-- InformaciÃ³n adicional: solo participantes y presupuesto -->
          <div class="resumen-info" style="margin-top: 8px; display: flex; gap: 12px; flex-wrap: wrap;">
            <span class="badge" *ngIf="e.cantParticipantes !== undefined && e.cantParticipantes > 0" style="background: #4CAF50; color: white; padding: 2px 8px; border-radius: 12px; font-size: 12px;">
              ğŸ‘¥ {{ e.cantParticipantes }} participante{{ e.cantParticipantes !== 1 ? 's' : '' }}
            </span>
            <span class="badge" *ngIf="e.presupuestoTotal !== undefined && e.presupuestoTotal > 0" style="background: #2196F3; color: white; padding: 2px 8px; border-radius: 12px; font-size: 12px;">
              ğŸ’° ${{ e.presupuestoTotal | number:'1.0-0' }}
            </span>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- NavegaciÃ³n inferior -->
  <nav class="bottom" aria-label="NavegaciÃ³n">
    <div class="nav-wrap">
      <a class="tab active" routerLink="/home">ğŸ—“ï¸ <span>Calendario</span></a>
      <a class="tab" routerLink="/chats">ğŸ’¬ <span>Chats</span></a>
      <a class="tab" routerLink="/search">ğŸ” <span>Buscar</span></a>
      <a class="tab" routerLink="/account">âš™ï¸ <span>Cuenta</span></a>
      <a class="tab" routerLink="/notifications">ğŸ”” <span>Notificaciones</span></a>
    </div>
  </nav>
</body>
