<body>
  <!-- Header tipo WhatsApp -->
  <header class="chat-header">
    <button class="back-btn" (click)="goBack()" aria-label="Volver a chats">
      â†
    </button>
    <div class="chat-info">
      <div class="avatar-small">{{ encuentro?.titulo?.substring(0, 2).toUpperCase() || 'EN' }}</div>
      <div class="info-text">
        <div class="chat-title">{{ encuentro?.titulo || 'Chat' }}</div>
        <div class="chat-subtitle">{{ encuentro?.lugar || 'Encuentro' }}</div>
      </div>
    </div>
    <button class="add-friends-btn" (click)="toggleAddFriends()" aria-label="Agregar amigos">
      ğŸ‘¥+
    </button>
  </header>

  <!-- Modal para agregar amigos -->
  <div class="modal-overlay" *ngIf="showAddFriends" (click)="toggleAddFriends()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>ğŸ‘¥ Agregar Participantes</h3>
        <button class="btn-close-modal" (click)="toggleAddFriends()">âœ•</button>
      </div>
      
      <div class="modal-body">
        <!-- Estado de carga -->
        <div *ngIf="loadingFriends" class="loading-state">
          <div class="spinner">â³</div>
          <p>Cargando amigos...</p>
        </div>

        <!-- Lista de amigos -->
        <div *ngIf="!loadingFriends && friends.length > 0" class="friends-list">
          <div *ngFor="let friend of friends" class="friend-item">
            <div class="friend-avatar">
              {{ friend.nombre?.substring(0, 1).toUpperCase() }}{{ friend.apellido?.substring(0, 1).toUpperCase() }}
            </div>
            <div class="friend-info">
              <div class="friend-name">{{ friend.nombre }} {{ friend.apellido }}</div>
              <div class="friend-email">{{ friend.email }}</div>
            </div>
            <button 
              class="btn-add-friend" 
              (click)="addParticipante(friend)"
              [disabled]="friend.isParticipante"
            >
              <span *ngIf="!friend.isParticipante">â• Agregar</span>
              <span *ngIf="friend.isParticipante">âœ“ Agregado</span>
            </button>
          </div>
        </div>

        <!-- Estado vacÃ­o -->
        <div *ngIf="!loadingFriends && friends.length === 0" class="empty-friends">
          <div class="empty-icon">ğŸ‘¤</div>
          <p>No tienes amigos para agregar</p>
          <small>Agrega amigos desde la secciÃ³n de bÃºsqueda</small>
        </div>
      </div>
      
      <div class="modal-footer">
        <button class="btn-cancel" (click)="toggleAddFriends()">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- Ãrea de mensajes (simulada) -->
  <main class="chat-messages">
    <div class="empty-state">
      <div class="empty-icon">ğŸ’¬</div>
      <h3>Chat del encuentro</h3>
      <p>Este es un chat simulado para tu encuentro "{{ encuentro?.titulo }}"</p>
      <p class="muted">Los mensajes aparecerÃ¡n aquÃ­ cuando la funcionalidad estÃ© completa</p>
    </div>
  </main>

  <!-- Barra inferior para enviar mensajes -->
  <footer class="chat-footer">
    <div class="message-input-container">
      <button class="attach-btn" aria-label="Adjuntar archivo">
        ğŸ“
      </button>
      <input 
        type="text" 
        class="message-input" 
        placeholder="Escribe un mensaje..."
        [(ngModel)]="messageText"
        (keyup.enter)="sendMessage()"
        aria-label="Escribe un mensaje"
      >
      <button 
        class="send-btn" 
        (click)="sendMessage()"
        [disabled]="!messageText.trim()"
        aria-label="Enviar mensaje"
      >
        ğŸ“¤
      </button>
    </div>
  </footer>
</body>
